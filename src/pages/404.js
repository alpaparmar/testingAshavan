import React from 'react'
import { allContent } from '../utils/content';
import { DynamicComponent } from '../components/components-registry';
// import { sourcebitDataClient } from 'sourcebit-target-next'
// import { withRemoteDataUpdates } from 'sourcebit-target-next/with-remote-data-updates'
import { getComponent } from '../components/components-registry';
import { resolveStaticProps } from '../utils/static-props-resolvers.ts';

// copied from [[...slug]].js
function Page(props) {
    // const { page, site } = props;
    // const { layout } = page;

    // if (!layout) {
    //     throw new Error(`page has no layout, page '${props.path}'`);
    // }
    // const PageLayout = getComponent(layout);
    // if (!PageLayout) {
    //     throw new Error(`no page layout matching the layout: ${layout}`);
    // }
    // console.info('scsdcsdsdcdsc props props', props)
    return <DynamicComponent {...props} />;
}

// copied from [[...slug]].js
export async function getStaticProps({ params }) {
    // The "data" object is generated by sourcebit.js and cached inside .sourcebit-nextjs-cache.json
    // const data = await sourcebitDataClient.getData();
    const urlPath = '/404'; // hard-coded to /404 since "+ (params.slug || []).join('/');" wasn't working
    const props = await resolveStaticProps(urlPath, allContent());
    return { props };
}

export default Page;